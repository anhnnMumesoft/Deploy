{"ast":null,"code":"var _jsxFileName = \"E:\\\\SourceDoAn\\\\front-end\\\\src\\\\container\\\\System\\\\Message\\\\Message.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useEffect, useState, useRef } from 'react';\nimport { useFetchAllcode } from '../../customize/fetch';\nimport { listRoomOfAdmin } from '../../../services/userService';\nimport moment from 'moment';\nimport { toast } from 'react-toastify';\nimport { BrowserRouter as Router, Switch, Route, Link, Redirect } from \"react-router-dom\";\nimport MessageDisscution from '../../Message/MessageDisscution';\nimport ChatWindow from '../../Message/ChatWindow';\nimport socketIOClient from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nrequire('dotenv').config();\n\nconst Message = () => {\n  _s();\n\n  const [dataUser, setdataUser] = useState({});\n  const [dataRoom, setdataRoom] = useState([]);\n  const [selectedRoom, setselectedRoom] = useState('');\n  const host = process.env.REACT_APP_BACKEND_URL;\n  const socketRef = useRef();\n  const [id, setId] = useState();\n  useEffect(() => {\n    socketRef.current = socketIOClient.connect(host);\n    const userData = JSON.parse(localStorage.getItem('userData'));\n    setdataUser(userData);\n    socketRef.current.on('getId', data => {\n      setId(data);\n    }); // phần này đơn giản để gán id cho mỗi phiên kết nối vào page. Mục đích chính là để phân biệt đoạn nào là của mình đang chat.\n\n    fetchListRoom();\n    socketRef.current.on('sendDataServer', dataGot => {\n      fetchListRoom();\n    });\n    socketRef.current.on('loadRoomServer', dataGot => {\n      fetchListRoom(userData.id);\n    });\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, []);\n\n  let handleClickRoom = roomId => {\n    socketRef.current.emit('loadRoomClient');\n    setselectedRoom(roomId);\n  };\n\n  let fetchListRoom = async () => {\n    let res = await listRoomOfAdmin();\n\n    if (res && res.errCode == 0) {\n      setdataRoom(res.data);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ks-page-content\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ks-page-content-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ks-messenger\",\n          children: [/*#__PURE__*/_jsxDEV(MessageDisscution, {\n            userId: dataUser.id,\n            isAdmin: true,\n            handleClickRoom: handleClickRoom,\n            data: dataRoom\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 18\n          }, this), selectedRoom ? /*#__PURE__*/_jsxDEV(ChatWindow, {\n            userId: dataUser.id,\n            roomId: selectedRoom\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 34\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"title\",\n              children: \"Ch\\u01B0a ch\\u1ECDn ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Message, \"pcnBV7Ac3x5f7ltWurODz4gzDsg=\");\n\n_c = Message;\nexport default Message;\n\nvar _c;\n\n$RefreshReg$(_c, \"Message\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useFetchAllcode","listRoomOfAdmin","moment","toast","BrowserRouter","Router","Switch","Route","Link","Redirect","MessageDisscution","ChatWindow","socketIOClient","require","config","Message","dataUser","setdataUser","dataRoom","setdataRoom","selectedRoom","setselectedRoom","host","process","env","REACT_APP_BACKEND_URL","socketRef","id","setId","current","connect","userData","JSON","parse","localStorage","getItem","on","data","fetchListRoom","dataGot","disconnect","handleClickRoom","roomId","emit","res","errCode"],"sources":["E:/SourceDoAn/front-end/src/container/System/Message/Message.js"],"sourcesContent":["import React from 'react';\r\nimport { useEffect, useState ,useRef} from 'react';\r\nimport { useFetchAllcode } from '../../customize/fetch';\r\nimport {  listRoomOfAdmin} from '../../../services/userService';\r\nimport moment from 'moment';\r\nimport { toast } from 'react-toastify';\r\n\r\nimport {\r\n    BrowserRouter as Router,\r\n    Switch,\r\n    Route,\r\n    Link,\r\n    Redirect\r\n} from \"react-router-dom\";\r\nimport MessageDisscution from '../../Message/MessageDisscution';\r\nimport ChatWindow from '../../Message/ChatWindow';\r\nimport socketIOClient from \"socket.io-client\";\r\nrequire('dotenv').config();\r\nconst Message = () => {\r\n  const [dataUser, setdataUser] = useState({})\r\n    const [dataRoom, setdataRoom] = useState([])\r\n  const [selectedRoom, setselectedRoom] = useState('')\r\n  const host = process.env.REACT_APP_BACKEND_URL;\r\n  const socketRef = useRef();\r\n  const [id, setId] = useState();\r\n  useEffect(()=>{\r\n    socketRef.current = socketIOClient.connect(host)\r\n    const userData = JSON.parse(localStorage.getItem('userData'));\r\n    setdataUser(userData)\r\n    socketRef.current.on('getId', data => {\r\n      setId(data)\r\n    }) // phần này đơn giản để gán id cho mỗi phiên kết nối vào page. Mục đích chính là để phân biệt đoạn nào là của mình đang chat.\r\n    fetchListRoom()\r\n    socketRef.current.on('sendDataServer', dataGot => {\r\n      fetchListRoom()\r\n      }) \r\n      socketRef.current.on('loadRoomServer', dataGot => {\r\n        fetchListRoom(userData.id)\r\n        })  \r\n      return () => {\r\n        socketRef.current.disconnect();\r\n      };\r\n  },[])\r\n let handleClickRoom = (roomId)=>{\r\n    socketRef.current.emit('loadRoomClient')\r\n    setselectedRoom(roomId)\r\n   \r\n }\r\n let fetchListRoom = async() =>{\r\n  let res = await listRoomOfAdmin()\r\n  if(res && res.errCode==0){\r\n    setdataRoom(res.data)\r\n  }\r\n}\r\n    return (\r\n        <div className=\"container\">\r\n        <div className=\"ks-page-content\">\r\n          <div className=\"ks-page-content-body\">\r\n            <div className=\"ks-messenger\">\r\n                 <MessageDisscution userId={dataUser.id} isAdmin={true} handleClickRoom={handleClickRoom} data={dataRoom}/>\r\n                 {selectedRoom ? <ChatWindow userId={dataUser.id} roomId={selectedRoom}  />\r\n                 :<div>\r\n                    <span className='title'>Chưa chọn phòng</span>\r\n                 </div> \r\n                }\r\n                \r\n             \r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n}\r\nexport default Message;"],"mappings":"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"},"metadata":{},"sourceType":"module"}