{"ast":null,"code":"import _regeneratorRuntime from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useState}from'react';import{Link,NavLink,useHistory,useParams,useLocation}from'react-router-dom';import{paymentOrderVnpaySuccessService,confirmOrderVnpay}from'../../services/userService';import'./OrderHomePage.scss';import{toast}from'react-toastify';import CommonUtils from'../../utils/CommonUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function useQuery(){var _useLocation=useLocation(),search=_useLocation.search;return React.useMemo(function(){return new URLSearchParams(search);},[search]);}function VnpayPaymentSuccess(props){var query=useQuery();useEffect(function(){var objectParam={vnp_Amount:query.get('vnp_Amount'),vnp_BankCode:query.get('vnp_BankCode'),vnp_BankTranNo:query.get('vnp_BankTranNo'),vnp_CardType:query.get('vnp_CardType'),vnp_OrderInfo:query.get('vnp_OrderInfo'),vnp_PayDate:query.get('vnp_PayDate'),vnp_ResponseCode:query.get('vnp_ResponseCode'),vnp_TmnCode:query.get('vnp_TmnCode'),vnp_TransactionNo:query.get('vnp_TransactionNo'),vnp_TransactionStatus:query.get('vnp_TransactionStatus'),vnp_TxnRef:query.get('vnp_TxnRef'),vnp_SecureHash:query.get('vnp_SecureHash')};var confirm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var orderData,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:orderData=JSON.parse(localStorage.getItem(\"orderData\"));localStorage.removeItem(\"orderData\");if(!orderData){_context.next=7;break;}_context.next=5;return confirmOrderVnpay(objectParam);case 5:res=_context.sent;if(res&&res.errCode==0){createNewOrder(orderData);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function confirm(){return _ref.apply(this,arguments);};}();confirm();},[]);var createNewOrder=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var res,userData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return paymentOrderVnpaySuccessService(data);case 2:res=_context2.sent;if(res&&res.errCode==0){toast.success(\"Thanh toán hóa đơn thành công\");userData=JSON.parse(localStorage.getItem('userData'));setTimeout(function(){window.location.href='/user/order/'+userData.id;},2000);}else{toast.error(res.errMessgae);}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function createNewOrder(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wrap-order\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wrap-heading-order\",children:[/*#__PURE__*/_jsx(NavLink,{to:\"/\",className:\"navbar-brand logo_h\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/resources/img/logo.png\",alt:\"\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Thanh To\\xE1n VNPAY\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"wrap-order-item\",children:/*#__PURE__*/_jsx(\"section\",{className:\"cart_area\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"cart_inner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-3 py-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"text-right\",children:\"Th\\xF4ng tin thanh to\\xE1n\"})})})})})})})})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'100px',backgroundColor:'#f5f5f5'}})]});}export default VnpayPaymentSuccess;","map":{"version":3,"names":["React","useEffect","useState","Link","NavLink","useHistory","useParams","useLocation","paymentOrderVnpaySuccessService","confirmOrderVnpay","toast","CommonUtils","useQuery","search","useMemo","URLSearchParams","VnpayPaymentSuccess","props","query","objectParam","vnp_Amount","get","vnp_BankCode","vnp_BankTranNo","vnp_CardType","vnp_OrderInfo","vnp_PayDate","vnp_ResponseCode","vnp_TmnCode","vnp_TransactionNo","vnp_TransactionStatus","vnp_TxnRef","vnp_SecureHash","confirm","orderData","JSON","parse","localStorage","getItem","removeItem","res","errCode","createNewOrder","data","success","userData","setTimeout","window","location","href","id","error","errMessgae","width","height","backgroundColor"],"sources":["E:/TestDeploy/frontend/src/container/Order/VnpayPaymentSuccess.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, NavLink, useHistory, useParams,useLocation  } from 'react-router-dom';\r\n\r\nimport {\r\n    paymentOrderVnpaySuccessService,confirmOrderVnpay\r\n} from '../../services/userService';\r\nimport './OrderHomePage.scss';\r\n\r\nimport { toast } from 'react-toastify';\r\n\r\nimport CommonUtils from '../../utils/CommonUtils';\r\nfunction useQuery() {\r\n    const { search } = useLocation();\r\n  \r\n    return React.useMemo(() => new URLSearchParams(search), [search]);\r\n  }\r\nfunction VnpayPaymentSuccess(props) {\r\n    let query = useQuery();\r\n    useEffect(() => {\r\n        let objectParam = {\r\n            vnp_Amount:query.get('vnp_Amount'),\r\n            vnp_BankCode:query.get('vnp_BankCode'),\r\n            vnp_BankTranNo:query.get('vnp_BankTranNo'),\r\n            vnp_CardType:query.get('vnp_CardType'),\r\n            vnp_OrderInfo:query.get('vnp_OrderInfo'),\r\n            vnp_PayDate:query.get('vnp_PayDate'),\r\n            vnp_ResponseCode:query.get('vnp_ResponseCode'),\r\n            vnp_TmnCode:query.get('vnp_TmnCode'),\r\n            vnp_TransactionNo:query.get('vnp_TransactionNo'),\r\n            vnp_TransactionStatus:query.get('vnp_TransactionStatus'),\r\n            vnp_TxnRef:query.get('vnp_TxnRef'),\r\n            vnp_SecureHash:query.get('vnp_SecureHash')\r\n        \r\n        }\r\n        let confirm = async()=>{\r\n            let orderData =  JSON.parse(localStorage.getItem(\"orderData\"))\r\n            localStorage.removeItem(\"orderData\")\r\n          \r\n\r\n               \r\n                if(orderData){\r\n                    let res = await confirmOrderVnpay(objectParam)\r\n                    if(res && res.errCode == 0){\r\n\r\n                    createNewOrder(orderData)\r\n                }\r\n            }\r\n        }\r\n        confirm()\r\n    }, [])\r\n    let createNewOrder = async (data) =>{\r\n        let res = await paymentOrderVnpaySuccessService(data)\r\n        if(res && res.errCode ==0){\r\n            toast.success(\"Thanh toán hóa đơn thành công\")\r\n            const userData = JSON.parse(localStorage.getItem('userData'));\r\n            setTimeout(()=>{\r\n                window.location.href='/user/order/'+userData.id\r\n            },2000)\r\n        }else{\r\n            toast.error(res.errMessgae)\r\n        }\r\n    }\r\n    return (\r\n\r\n        <>\r\n\r\n            <div className=\"wrap-order\">\r\n                <div className=\"wrap-heading-order\">\r\n                    <NavLink to=\"/\" className=\"navbar-brand logo_h\">\r\n                        <img src=\"/resources/img/logo.png\" alt=\"\" />\r\n                    </NavLink>\r\n                    <span>Thanh Toán VNPAY</span>\r\n                </div>\r\n               \r\n                <div className=\"wrap-order-item\">\r\n                    <section className=\"cart_area\">\r\n                        <div className=\"container\">\r\n                            <div className=\"cart_inner\">\r\n                            <div className=\"col-md-12\">\r\n                    <div className=\"p-3 py-5\">\r\n                        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n                            <h4 className=\"text-right\">Thông tin thanh toán</h4>\r\n                        </div>\r\n                       \r\n                       \r\n                        \r\n                    </div>\r\n                </div>\r\n                            </div>\r\n\r\n                            \r\n\r\n                        </div>\r\n\r\n\r\n                    </section>\r\n                </div>\r\n               \r\n             \r\n            </div>\r\n            <div style={{ width: '100%', height: '100px', backgroundColor: '#f5f5f5' }}></div>\r\n        </>\r\n\r\n    );\r\n}\r\n\r\nexport default VnpayPaymentSuccess;"],"mappings":"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"},"metadata":{},"sourceType":"module"}