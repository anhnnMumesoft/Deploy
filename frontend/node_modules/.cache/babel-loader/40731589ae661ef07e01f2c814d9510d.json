{"ast":null,"code":"import _regeneratorRuntime from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useParams}from\"react-router-dom\";import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MessageDisscution(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),dataRoom=_useState2[0],setdataRoom=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),textSearch=_useState4[0],settextSearch=_useState4[1];var count;useEffect(function(){if(props.data){loadRoom(props.data);}},[props.data]);var handleClickRoom=function handleClickRoom(roomId){props.handleClickRoom(roomId);};var loadRoom=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data=data.sort(function(a,b){var count1=0;var count2=0;a.messageData.forEach(function(item){if(item.unRead===1)count1=count1+1;});b.messageData.forEach(function(item){if(item.unRead===1)count2=count2+1;});return count2-count1;});setdataRoom(data);case 2:case\"end\":return _context.stop();}}},_callee);}));return function loadRoom(_x){return _ref.apply(this,arguments);};}();var handleOnchangeSearch=function handleOnchangeSearch(e){settextSearch(e.target.value);};var handleSearchRoom=function handleSearchRoom(roomList){dataRoom.forEach(function(item){var name='';if(props.isAdmin===true){name=item.userOneData.firstName+\" \"+item.userOneData.lastName;}else{name=item.userTwoData.firstName+\" \"+item.userTwoData.lastName;}if(name.toLowerCase().indexOf(textSearch.toLowerCase())!==-1){roomList.push(item);}});};var roomList=[];handleSearchRoom(roomList);return/*#__PURE__*/_jsxs(\"div\",{className:\"ks-discussions\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ks-search\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-icon icon-right icon icon-lg icon-color-primary\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return handleOnchangeSearch(e);},value:textSearch,id:\"input-group-icon-text\",type:\"text\",className:\"form-control\",placeholder:\"T\\xECm ki\\u1EBFm theo t\\xEAn\"}),/*#__PURE__*/_jsx(\"span\",{className:\"icon-addon\",children:/*#__PURE__*/_jsx(\"span\",{className:\"la la-search\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ks-body ks-scrollable jspScrollable\",\"data-auto-height\":true,style:{height:'400px',overflowY:'auto',padding:'0px',width:'339px'},tabIndex:0,children:/*#__PURE__*/_jsxs(\"div\",{className:\"jspContainer\",style:{width:'339px',height:'550px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"jspPane\",style:{padding:'0px',top:'0px',width:'329px'},children:/*#__PURE__*/_jsx(\"ul\",{className:\"ks-items\",children:roomList&&roomList.length>0&&roomList.map(function(item,index){var userData={};count=0;props.isAdmin===true?userData=item.userOneData:userData=item.userTwoData;item.messageData.forEach(function(element){if(element.unRead===1&&element.userId!==props.userId)count=count+1;});return/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){return handleClickRoom(item.id);},className:\"ks-item\",children:/*#__PURE__*/_jsxs(\"a\",{href:\"#\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"ks-avatar\",children:[/*#__PURE__*/_jsx(\"img\",{src:userData.image,width:36,height:36}),/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-pill badge-danger ks-badge ks-notify\",children:count&&count>0?count:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ks-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ks-name\",children:[userData.firstName+\" \"+userData.lastName,/*#__PURE__*/_jsx(\"span\",{className:\"ks-datetime\",children:item.messageData&&item.messageData.length>0?moment(item.messageData[item.messageData.length-1].createdAt).fromNow():''})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ks-message\",children:item.messageData&&item.messageData.length>0?item.messageData[item.messageData.length-1].text:'Chưa có tin nhắn'})]})]})},index);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"jspVerticalBar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"jspCap jspCapTop\"}),/*#__PURE__*/_jsx(\"div\",{className:\"jspTrack\",style:{height:'550px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"jspDrag\",style:{height:'261px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"jspDragTop\"}),/*#__PURE__*/_jsx(\"div\",{className:\"jspDragBottom\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"jspCap jspCapBottom\"})]})]})})]});}export default MessageDisscution;","map":{"version":3,"names":["React","useEffect","useState","useParams","moment","MessageDisscution","props","dataRoom","setdataRoom","textSearch","settextSearch","count","data","loadRoom","handleClickRoom","roomId","sort","a","b","count1","count2","messageData","forEach","item","unRead","handleOnchangeSearch","e","target","value","handleSearchRoom","roomList","name","isAdmin","userOneData","firstName","lastName","userTwoData","toLowerCase","indexOf","push","height","overflowY","padding","width","top","length","map","index","userData","element","userId","id","image","createdAt","fromNow","text"],"sources":["E:/TestDeploy/frontend/src/container/Message/MessageDisscution.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from \"react-router-dom\";\r\nimport moment from 'moment';\r\nfunction MessageDisscution(props) {\r\n  const [dataRoom, setdataRoom] = useState([])\r\n  const [textSearch,settextSearch] = useState('')\r\n  var count \r\n  useEffect(()=>{\r\n    if(props.data){\r\n      loadRoom(props.data)\r\n    }\r\n  },[props.data])\r\n  let handleClickRoom = (roomId) =>{\r\n    \r\n    props.handleClickRoom(roomId)\r\n  \r\n   \r\n  }\r\n  let loadRoom = async(data) =>{\r\n    data =data.sort((a,b) => {\r\n      let count1 = 0;\r\n      let count2 = 0;\r\n      a.messageData.forEach((item) =>{\r\n        if(item.unRead === 1) count1 = count1 +1;\r\n      })\r\n      b.messageData.forEach((item) =>{\r\n        if(item.unRead === 1) count2 = count2 +1;\r\n      })\r\n      return count2 -count1;\r\n    })\r\n    setdataRoom(data)\r\n  }\r\n  let handleOnchangeSearch = (e) =>{\r\n    settextSearch(e.target.value)\r\n  }\r\n  let handleSearchRoom = (roomList) => {\r\n    dataRoom.forEach((item) => {\r\n      let name = ''\r\n      if(props.isAdmin === true){\r\n        name = item.userOneData.firstName + \" \"+item.userOneData.lastName\r\n      }else{\r\n        name = item.userTwoData.firstName + \" \"+item.userTwoData.lastName\r\n      }\r\n     \r\n        if (name.toLowerCase().indexOf(textSearch.toLowerCase()) !== -1) {\r\n          roomList.push(item)\r\n        }\r\n    })\r\n}\r\nlet roomList = []\r\nhandleSearchRoom(roomList)\r\n    return (\r\n\r\n        <div className=\"ks-discussions\">\r\n        <div className=\"ks-search\">\r\n          <div className=\"input-icon icon-right icon icon-lg icon-color-primary\">\r\n            <input onChange={(e) => handleOnchangeSearch(e)} value={textSearch} id=\"input-group-icon-text\" type=\"text\" className=\"form-control\" placeholder=\"Tìm kiếm theo tên\" />\r\n            <span className=\"icon-addon\">\r\n              <span className=\"la la-search\" />\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div className=\"ks-body ks-scrollable jspScrollable\" data-auto-height style={{height: '400px', overflowY: 'auto', padding: '0px', width: '339px'}} tabIndex={0}>\r\n          <div className=\"jspContainer\" style={{width: '339px', height: '550px'}}>\r\n            <div className=\"jspPane\" style={{padding: '0px', top: '0px', width: '329px'}}>\r\n              <ul className=\"ks-items\">\r\n              \r\n                \r\n             {roomList && roomList.length > 0 && \r\n              roomList.map((item,index) =>{\r\n                let userData = {}\r\n                count = 0\r\n                props.isAdmin === true ? (userData=item.userOneData) : (userData=item.userTwoData)\r\n                item.messageData.forEach(element => {\r\n                  if(element.unRead ===1 && element.userId !== props.userId)\r\n                  count = count +1;\r\n                });\r\n                return(\r\n                  <li onClick={() => handleClickRoom(item.id)} key={index} className=\"ks-item\">\r\n                  <a href=\"#\">\r\n                    <span className=\"ks-avatar\">\r\n                      <img src={userData.image} width={36} height={36} />\r\n                      <span className=\"badge badge-pill badge-danger ks-badge ks-notify\">{count && count > 0 ? count : ''}</span>\r\n                    </span>\r\n                    <div className=\"ks-body\">\r\n                      <div className=\"ks-name\">\r\n                        {userData.firstName +\" \"+userData.lastName}\r\n                        <span className=\"ks-datetime\">{item.messageData && item.messageData.length > 0 ? moment(item.messageData[item.messageData.length-1].createdAt).fromNow():''}</span>\r\n                      </div>\r\n                      <div className=\"ks-message\">{item.messageData && item.messageData.length > 0 ? item.messageData[item.messageData.length-1].text :'Chưa có tin nhắn'}</div>\r\n                    </div>\r\n                  </a>\r\n                </li>\r\n                )\r\n              })\r\n             }\r\n              \r\n             \r\n           \r\n                \r\n              </ul>\r\n            </div>\r\n            <div className=\"jspVerticalBar\">\r\n              <div className=\"jspCap jspCapTop\" />\r\n              <div className=\"jspTrack\" style={{height: '550px'}}>\r\n                <div className=\"jspDrag\" style={{height: '261px'}}>\r\n                  <div className=\"jspDragTop\" />\r\n                  <div className=\"jspDragBottom\" />\r\n                </div>\r\n              </div>\r\n              <div className=\"jspCap jspCapBottom\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default MessageDisscution;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}