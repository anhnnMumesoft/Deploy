{"ast":null,"code":"import _regeneratorRuntime from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/TestDeploy/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import VoucherItem from'../Voucher/VoucherItem';import logoVoucher from'../../../src/resources/img/logoVoucher.png';import{BrowserRouter as Router,Switch,Route,Link,Redirect}from\"react-router-dom\";import'./StoreVoucher.scss';import VoucherItemSmall from'./VoucherItemSmall';import{getAllVoucherByUserIdService}from'../../services/userService';import moment,{now}from'moment';import{toast}from'react-toastify';import{PAGINATION}from'../../utils/constant';import CommonUtils from'../../utils/CommonUtils';import LoadingSpinner from'../../component/Spinner/LoadingSpinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function StoreVoucher(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState({codeVoucher:'',activeBtn:false}),_useState4=_slicedToArray(_useState3,2),inputValues=_useState4[0],setInputValues=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dataVoucher=_useState6[0],setdataVoucher=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),count=_useState8[0],setCount=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),numberPage=_useState10[0],setnumberPage=_useState10[1];function compareDates(d1,d2){var parts=d1.split('/');var d1=Number(parts[2]+parts[1]+parts[0]);parts=d2.split('/');var d2=Number(parts[2]+parts[1]+parts[0]);if(d1<=d2)return true;if(d1>=d2)return false;}useEffect(function(){setIsLoading(true);// Start loading\nvar id=props.id;if(id){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var arrData,arrTemp,nowDate,i,fromDate,toDate,amount,usedAmount;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAllVoucherByUserIdService({limit:PAGINATION.pagerow,offset:0,id:props.id});case 2:arrData=_context.sent;arrTemp=[];if(arrData&&arrData.errCode===0){nowDate=moment.unix(Date.now()/1000).format('DD/MM/YYYY');for(i=0;i<arrData.data.length;i++){fromDate=moment.unix(arrData.data[i].voucherData.fromDate/1000).format('DD/MM/YYYY');toDate=moment.unix(arrData.data[i].voucherData.toDate/1000).format('DD/MM/YYYY');amount=arrData.data[i].voucherData.amount;usedAmount=arrData.data[i].voucherData.usedAmount;if(amount!==usedAmount&&compareDates(toDate,nowDate)===false&&compareDates(fromDate,nowDate)===true){arrTemp[i]=arrData.data[i];}}setdataVoucher(arrTemp);setCount(Math.ceil(arrData.count/PAGINATION.pagerow));}setIsLoading(false);// End loading after all fetches\ncase 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();}},[props.id]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container rounded bg-white mt-5 mb-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 border-right border-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"box-heading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content-left\",children:/*#__PURE__*/_jsx(\"span\",{children:\"V\\xED voucher\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"container-voucher\",children:dataVoucher&&dataVoucher.length>0&&dataVoucher.map(function(item,index){var percent=\"\";if(item.voucherData.typeVoucherOfVoucherData.typeVoucher===\"percent\"){percent=item.voucherData.typeVoucherOfVoucherData.value+\"%\";}if(item.voucherData.typeVoucherOfVoucherData.typeVoucher===\"money\"){percent=CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.value);}var MaxValue=CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.maxValue);var MinValue=CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.minValue);return/*#__PURE__*/_jsx(VoucherItemSmall,{id:item.id,name:item.voucherData.codeVoucher,widthPercent:item.voucherData.usedAmount*100/item.voucherData.amount,maxValue:MaxValue,minValue:MinValue,usedAmount:Math.round(item.voucherData.usedAmount*100/item.voucherData.amount*10)/10,typeVoucher:percent},index);})})]})}),isLoading&&/*#__PURE__*/_jsx(LoadingSpinner,{})]});}export default StoreVoucher;","map":{"version":3,"names":["React","useState","useEffect","VoucherItem","logoVoucher","BrowserRouter","Router","Switch","Route","Link","Redirect","VoucherItemSmall","getAllVoucherByUserIdService","moment","now","toast","PAGINATION","CommonUtils","LoadingSpinner","StoreVoucher","props","isLoading","setIsLoading","codeVoucher","activeBtn","inputValues","setInputValues","dataVoucher","setdataVoucher","count","setCount","numberPage","setnumberPage","compareDates","d1","d2","parts","split","Number","id","fetchData","limit","pagerow","offset","arrData","arrTemp","errCode","nowDate","unix","Date","format","i","data","length","fromDate","voucherData","toDate","amount","usedAmount","Math","ceil","map","item","index","percent","typeVoucherOfVoucherData","typeVoucher","value","formatter","MaxValue","maxValue","MinValue","minValue","round"],"sources":["E:/TestDeploy/frontend/src/container/User/StoreVoucher.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport VoucherItem from '../Voucher/VoucherItem';\r\nimport logoVoucher from '../../../src/resources/img/logoVoucher.png'\r\nimport {\r\n    BrowserRouter as Router,\r\n    Switch,\r\n    Route,\r\n    Link,\r\n    Redirect\r\n} from \"react-router-dom\";\r\nimport './StoreVoucher.scss';\r\nimport VoucherItemSmall from './VoucherItemSmall';\r\nimport { getAllVoucherByUserIdService } from '../../services/userService';\r\nimport moment, { now } from 'moment';\r\nimport { toast } from 'react-toastify';\r\nimport { PAGINATION } from '../../utils/constant';\r\nimport CommonUtils from '../../utils/CommonUtils';\r\nimport LoadingSpinner from '../../component/Spinner/LoadingSpinner';\r\nfunction StoreVoucher(props) {\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [inputValues, setInputValues] = useState({\r\n        codeVoucher: '', activeBtn: false\r\n    });\r\n    const [dataVoucher, setdataVoucher] = useState([])\r\n    const [count, setCount] = useState('')\r\n    const [numberPage, setnumberPage] = useState('')\r\n    function compareDates(d1, d2) {\r\n        var parts = d1.split('/');\r\n        var d1 = Number(parts[2] + parts[1] + parts[0]);\r\n        parts = d2.split('/');\r\n        var d2 = Number(parts[2] + parts[1] + parts[0]);\r\n        if (d1 <= d2) return true\r\n        if (d1 >= d2) return false\r\n\r\n    }\r\n    useEffect(() => {\r\n        setIsLoading(true); // Start loading\r\n        let id = props.id\r\n        if (id) {\r\n            let fetchData = async () => {\r\n                let arrData = await getAllVoucherByUserIdService({\r\n\r\n                    limit: PAGINATION.pagerow,\r\n                    offset: 0,\r\n                    id: props.id\r\n                })\r\n                let arrTemp = []\r\n                if (arrData && arrData.errCode === 0) {\r\n                    let nowDate = moment.unix(Date.now() / 1000).format('DD/MM/YYYY')\r\n\r\n                    for (let i = 0; i < arrData.data.length; i++) {\r\n                        let fromDate = moment.unix(arrData.data[i].voucherData.fromDate / 1000).format('DD/MM/YYYY')\r\n                        let toDate = moment.unix(arrData.data[i].voucherData.toDate / 1000).format('DD/MM/YYYY')\r\n                        let amount = arrData.data[i].voucherData.amount\r\n                        let usedAmount = arrData.data[i].voucherData.usedAmount\r\n                        if (amount !== usedAmount && compareDates(toDate, nowDate) === false && compareDates(fromDate, nowDate) === true) {\r\n                            arrTemp[i] = arrData.data[i]\r\n\r\n                        }\r\n                    }\r\n                    setdataVoucher(arrTemp)\r\n                    setCount(Math.ceil(arrData.count / PAGINATION.pagerow))\r\n                }\r\n                setIsLoading(false); // End loading after all fetches\r\n            }\r\n            fetchData()\r\n        }\r\n\r\n    }, [props.id])\r\n\r\n   \r\n \r\n    return (\r\n\r\n        <div className=\"container rounded bg-white mt-5 mb-5\">\r\n            <div className=\"row\">\r\n                <div className=\"col-md-12 border-right border-left\">\r\n                    <div className=\"box-heading\">\r\n                        <div className=\"content-left\">\r\n                            <span>VÃ­ voucher</span>\r\n                        </div>\r\n                     \r\n                    </div>\r\n                 \r\n                    <div className=\"container-voucher\">\r\n                        {dataVoucher && dataVoucher.length > 0 &&\r\n                            dataVoucher.map((item, index) => {\r\n                                let percent = \"\"\r\n                                if (item.voucherData.typeVoucherOfVoucherData.typeVoucher === \"percent\") {\r\n                                    percent = item.voucherData.typeVoucherOfVoucherData.value + \"%\"\r\n                                }\r\n                                if (item.voucherData.typeVoucherOfVoucherData.typeVoucher === \"money\") {\r\n                                    percent = CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.value)\r\n\r\n                                }\r\n                                let MaxValue = CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.maxValue)\r\n                                let MinValue = CommonUtils.formatter.format(item.voucherData.typeVoucherOfVoucherData.minValue)\r\n\r\n                                return (\r\n                                    <VoucherItemSmall id={item.id} key={index} name={item.voucherData.codeVoucher} widthPercent={item.voucherData.usedAmount * 100 / item.voucherData.amount} maxValue={MaxValue} minValue={MinValue} usedAmount={Math.round((item.voucherData.usedAmount * 100 / item.voucherData.amount) * 10) / 10} typeVoucher={percent} />\r\n                                )\r\n                            })\r\n                        }\r\n\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {isLoading && <LoadingSpinner />}\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default StoreVoucher;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}