{"ast":null,"code":"import _regeneratorRuntime from\"E:/TestDeploy/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"E:/TestDeploy/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"E:/TestDeploy/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"E:/TestDeploy/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/TestDeploy/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useEffect,useState}from'react';import CommonUtils from'../../../../utils/CommonUtils';import moment from'moment';import{toast}from'react-toastify';import Lightbox from'react-image-lightbox';import'react-image-lightbox/style.css';import{Modal,ModalHeader,ModalFooter,ModalBody,Button}from'reactstrap';import{BrowserRouter as Router,Switch,Route,Link,Redirect,useParams}from\"react-router-dom\";import{getProductDetailImageByIdService}from'../../../../services/userService';import LoadingSpinner from'../../../../component/Spinner/LoadingSpinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddImageModal=function AddImageModal(props){var _useState=useState({image:'',imageReview:'',caption:'',isOpen:false,isActionUpdate:false,id:''}),_useState2=_slicedToArray(_useState,2),inputValues=_useState2[0],setInputValues=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){var id=props.productImageId;console.log(\"check id\",id);if(id){var fetchProductImage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,_objectSpread2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);// Start loading\n_context.next=3;return getProductDetailImageByIdService(id);case 3:res=_context.sent;setIsLoading(false);// End loading after all fetches\nif(res&&res.errCode===0){setInputValues(_objectSpread(_objectSpread({},inputValues),{},(_objectSpread2={},_defineProperty(_objectSpread2,\"isActionUpdate\",true),_defineProperty(_objectSpread2,\"caption\",res.data.caption),_defineProperty(_objectSpread2,\"image\",res.data.image),_defineProperty(_objectSpread2,\"imageReview\",res.data.image),_objectSpread2)));}case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchProductImage(){return _ref.apply(this,arguments);};}();fetchProductImage();}},[props.isOpenModal]);var handleOnChange=function handleOnChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setInputValues(_objectSpread(_objectSpread({},inputValues),{},_defineProperty({},name,value)));};var handleOnChangeImage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var data,file,_objectSpread4,base64,objectUrl;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data=event.target.files;file=data[0];if(!(file.size>31312281)){_context2.next=6;break;}toast.error(\"Dung lượng file bé hơn 30mb\");_context2.next=11;break;case 6:_context2.next=8;return CommonUtils.getBase64(file);case 8:base64=_context2.sent;objectUrl=URL.createObjectURL(file);setInputValues(_objectSpread(_objectSpread({},inputValues),{},(_objectSpread4={},_defineProperty(_objectSpread4,\"image\",base64),_defineProperty(_objectSpread4,\"imageReview\",objectUrl),_objectSpread4)));case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function handleOnChangeImage(_x){return _ref2.apply(this,arguments);};}();var openPreviewImage=function openPreviewImage(){if(!inputValues.imageReview)return;setInputValues(_objectSpread(_objectSpread({},inputValues),{},_defineProperty({},\"isOpen\",true)));};var HandleSendDataFromModal=function HandleSendDataFromModal(){var _objectSpread6;props.sendDataFromModal({image:inputValues.image,caption:inputValues.caption,isActionUpdate:inputValues.isActionUpdate,id:props.productImageId});setInputValues(_objectSpread(_objectSpread({},inputValues),{},(_objectSpread6={},_defineProperty(_objectSpread6,\"image\",''),_defineProperty(_objectSpread6,\"imageReview\",''),_defineProperty(_objectSpread6,\"caption\",''),_defineProperty(_objectSpread6,\"isActionUpdate\",false),_objectSpread6)));};var handleCloseModal=function handleCloseModal(){var _objectSpread7;props.closeModal();setInputValues(_objectSpread(_objectSpread({},inputValues),{},(_objectSpread7={},_defineProperty(_objectSpread7,\"image\",''),_defineProperty(_objectSpread7,\"imageReview\",''),_defineProperty(_objectSpread7,\"caption\",''),_defineProperty(_objectSpread7,\"isActionUpdate\",false),_objectSpread7)));};return/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[isLoading&&/*#__PURE__*/_jsx(LoadingSpinner,{}),/*#__PURE__*/_jsxs(Modal,{isOpen:props.isOpenModal,className:'booking-modal-container',size:\"md\",centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",children:\"Th\\xEAm h\\xECnh \\u1EA3nh chi ti\\u1EBFt s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseModal,type:\"button\",className:\"btn btn-time\",\"aria-label\":\"Close\",children:\"X\"})]}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"T\\xEAn h\\xECnh \\u1EA3nh\"}),/*#__PURE__*/_jsx(\"input\",{value:inputValues.caption,name:\"caption\",onChange:function onChange(event){return handleOnChange(event);},type:\"text\",className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u1EA2nh hi\\u1EC3n th\\u1ECB\"}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\".concat(inputValues.imageReview,\")\")},onClick:function onClick(){return openPreviewImage();},className:\"img-review\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ch\\u1ECDn h\\xECnh \\u1EA3nh\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(event){return handleOnChangeImage(event);},type:\"file\",accept:\".jpg,.png\",className:\"form-control form-file\"})]})]})}),/*#__PURE__*/_jsxs(ModalFooter,{children:[/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:HandleSendDataFromModal,children:\"L\\u01B0u th\\xF4ng tin\"}),' ',/*#__PURE__*/_jsx(Button,{onClick:handleCloseModal,children:\"H\\u1EE7y\"})]})]}),inputValues.isOpen===true&&/*#__PURE__*/_jsx(Lightbox,{mainSrc:inputValues.imageReview,onCloseRequest:function onCloseRequest(){return setInputValues(_objectSpread(_objectSpread({},inputValues),{},_defineProperty({},\"isOpen\",false)));}})]});};export default AddImageModal;","map":{"version":3,"names":["React","useEffect","useState","CommonUtils","moment","toast","Lightbox","Modal","ModalHeader","ModalFooter","ModalBody","Button","BrowserRouter","Router","Switch","Route","Link","Redirect","useParams","getProductDetailImageByIdService","LoadingSpinner","AddImageModal","props","image","imageReview","caption","isOpen","isActionUpdate","id","inputValues","setInputValues","isLoading","setIsLoading","productImageId","console","log","fetchProductImage","res","errCode","data","isOpenModal","handleOnChange","event","target","name","value","handleOnChangeImage","files","file","size","error","getBase64","base64","objectUrl","URL","createObjectURL","openPreviewImage","HandleSendDataFromModal","sendDataFromModal","handleCloseModal","closeModal","backgroundImage"],"sources":["E:/TestDeploy/front-end/src/container/System/Product/ProductImage/AddImageModal.js"],"sourcesContent":["import React from 'react';\r\nimport { useEffect, useState } from 'react';\r\nimport CommonUtils from '../../../../utils/CommonUtils';\r\nimport moment from 'moment';\r\nimport { toast } from 'react-toastify';\r\nimport Lightbox from 'react-image-lightbox';\r\nimport 'react-image-lightbox/style.css';\r\nimport { Modal, ModalHeader, ModalFooter, ModalBody, Button } from 'reactstrap';\r\nimport {\r\n    BrowserRouter as Router,\r\n    Switch,\r\n    Route,\r\n    Link,\r\n    Redirect,\r\n    useParams\r\n} from \"react-router-dom\";\r\nimport { getProductDetailImageByIdService } from '../../../../services/userService';\r\nimport LoadingSpinner from '../../../../component/Spinner/LoadingSpinner';\r\n\r\nconst AddImageModal = (props) => {\r\n\r\n    const [inputValues, setInputValues] = useState({\r\n        image: '', imageReview: '', caption: '', isOpen: false, isActionUpdate: false, id: ''\r\n    });\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        let id = props.productImageId\r\n        console.log(\"check id\", id)\r\n        if (id) {\r\n            let fetchProductImage = async () => {\r\n                setIsLoading(true); // Start loading\r\n                let res = await getProductDetailImageByIdService(id)\r\n                setIsLoading(false); // End loading after all fetches\r\n                if (res && res.errCode === 0) {\r\n                    setInputValues({\r\n                        ...inputValues, [\"isActionUpdate\"]: true, [\"caption\"]: res.data.caption, [\"image\"]: res.data.image,\r\n                        [\"imageReview\"]: res.data.image\r\n                    })\r\n\r\n                }\r\n               \r\n            }\r\n            fetchProductImage();\r\n\r\n\r\n        }\r\n    }, [props.isOpenModal])\r\n\r\n\r\n\r\n    const handleOnChange = event => {\r\n        const { name, value } = event.target;\r\n        setInputValues({ ...inputValues, [name]: value });\r\n\r\n    };\r\n\r\n    let handleOnChangeImage = async (event) => {\r\n        let data = event.target.files;\r\n        let file = data[0];\r\n        if(file.size > 31312281){\r\n            toast.error(\"Dung lượng file bé hơn 30mb\")\r\n        }\r\n        else{\r\n            let base64 = await CommonUtils.getBase64(file);\r\n            let objectUrl = URL.createObjectURL(file)\r\n            setInputValues({ ...inputValues, [\"image\"]: base64, [\"imageReview\"]: objectUrl })\r\n\r\n        }\r\n    }\r\n    let openPreviewImage = () => {\r\n        if (!inputValues.imageReview) return;\r\n\r\n        setInputValues({ ...inputValues, [\"isOpen\"]: true })\r\n    }\r\n    let HandleSendDataFromModal = () => {\r\n        props.sendDataFromModal({\r\n            image: inputValues.image,\r\n            caption: inputValues.caption,\r\n            isActionUpdate: inputValues.isActionUpdate,\r\n            id: props.productImageId\r\n        })\r\n        setInputValues({ ...inputValues, [\"image\"]: '', [\"imageReview\"]: '', [\"caption\"]: '', [\"isActionUpdate\"]: false })\r\n\r\n    }\r\n    let handleCloseModal = () => {\r\n        props.closeModal()\r\n        setInputValues({ ...inputValues, [\"image\"]: '', [\"imageReview\"]: '', [\"caption\"]: '', [\"isActionUpdate\"]: false })\r\n    }\r\n    return (\r\n        <div className=\"\">\r\n         {isLoading && <LoadingSpinner />}\r\n            <Modal isOpen={props.isOpenModal} className={'booking-modal-container'}\r\n                size=\"md\" centered\r\n            >\r\n                <div className=\"modal-header\">\r\n                    <h5 className=\"modal-title\">Thêm hình ảnh chi tiết sản phẩm</h5>\r\n                    <button onClick={handleCloseModal} type=\"button\" className=\"btn btn-time\" aria-label=\"Close\">X</button>\r\n                </div>\r\n                <ModalBody>\r\n                    <div className=\"row\">\r\n                        <div className=\"col-12 form-group\">\r\n                            <label>Tên hình ảnh</label>\r\n                            <input value={inputValues.caption} name=\"caption\" onChange={(event) => handleOnChange(event)} type=\"text\" className=\"form-control\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"col-12 form-group\">\r\n                            <label>Ảnh hiển thị</label>\r\n                            <div style={{ backgroundImage: `url(${inputValues.imageReview})` }} onClick={() => openPreviewImage()} className=\"img-review\"></div>\r\n                        </div>\r\n                        <div className=\"col-12 form-group\">\r\n                            <label>Chọn hình ảnh</label>\r\n                            <input onChange={(event) => handleOnChangeImage(event)} type=\"file\" accept=\".jpg,.png\" className=\"form-control form-file\" />\r\n                        </div>\r\n                    </div>\r\n                </ModalBody>\r\n                <ModalFooter>\r\n                    <Button\r\n                        color=\"primary\"\r\n                        onClick={HandleSendDataFromModal}\r\n                    >\r\n                        Lưu thông tin\r\n                    </Button>\r\n                    {' '}\r\n                    <Button onClick={handleCloseModal}>\r\n                        Hủy\r\n                    </Button>\r\n                </ModalFooter>\r\n            </Modal>\r\n            {inputValues.isOpen === true &&\r\n                <Lightbox mainSrc={inputValues.imageReview}\r\n                    onCloseRequest={() => setInputValues({ ...inputValues, [\"isOpen\"]: false })}\r\n                />\r\n            }\r\n        </div >\r\n    )\r\n}\r\nexport default AddImageModal;"],"mappings":"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"},"metadata":{},"sourceType":"module"}